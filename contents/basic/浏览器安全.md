# 浏览器安全之网络攻击

### XSS攻击

XSS 全称是 Cross Site Scripting，为了与“CSS”区分开来，故简称 XSS，翻译过来就是“跨站脚本”。XSS 攻击是指黑客往 HTML 文件中或者 DOM 中注入恶意脚本，从而在用户浏览页面时利用注入的恶意脚本对用户实施攻击的一种手段。

### CSRF攻击

CSRF 英文全称是 Cross-site request forgery，所以又称为“跨站请求伪造”，是指黑客引诱用户打开黑客的网站，在黑客的网站中，利用用户的登录状态发起的跨站请求。简单来讲，CSRF 攻击就是黑客利用了用户的登录状态，并通过第三方的站点来做一些坏事。

和 XSS 不同的是，CSRF 攻击不需要将恶意代码注入用户的页面，仅仅是利用服务器的漏洞和用户的登录状态来实施攻击。

| 网络攻击类型 | XSS(跨站脚本攻击)                                            | CSRF(跨站请求伪造)                                           |
| :----------- | :----------------------------------------------------------- | ------------------------------------------------------------ |
| 全称         | cross site scripting                                         | cros-site request forgery                                    |
| 攻击能力     | 1.可以窃取 Cookie 信息 <br>2.可以监听用户行为<br>3.可以通过修改DOM伪造假登录窗口,用来欺骗用户输入用户名和密码等信息。<br>4.可以在页面内生成浮窗广告 |                                                              |
| 类型方式     | 1.存储型XSS攻击<br>2.反射型 XSS 攻击<br>3.基于 DOM 的 XSS 攻击 | 1.自动发起Get请求<br/>2.自动发起Post请求<br/>3.引诱用户点击链接 |
| 攻击步骤     | 1.首先黑客利用站点漏洞将一段恶意 JavaScript 代码提交到网站的数据库中<br>2.然后用户向网站请求包含了恶意 JavaScript 脚本的页面<br>3.当用户浏览该页面的时候，恶意脚本就会将用户的 Cookie 信息等数据上传到服务器。 | 发起 CSRF 攻击的三个必要条件：<br>1.目标站点一定要有 CSRF 漏洞；<br>2.用户要登录过目标站点，并且在浏览器上保持有该站点的登录状态；<br>3.需要用户打开一个第三方站点，可以是黑客的站点，也可以是一些论坛。 |
| 解决方案     | 1. 服务器对输入脚本进行过滤或转码<br>2.充分利用 CSP,实施严格的 CSP 可以有效地防范 XSS 攻,具体来讲 CSP 有如下几个功能：<br>a.限制加载其他域下的资源文件，这样即使黑客插入了一个 JavaScript 文件，这个 JavaScript 文件也是无法被加载的；<br>b.禁止向第三方域提交数据，这样用户数据也不会外泄；<br>c.禁止执行内联脚本和未授权的脚本；<br>d.还提供了上报机制，这样可以帮助我们尽快发现有哪些 XSS 攻击，以便尽快修复问题。<br>3.使用 HttpOnly 属性；使用 HttpOnly 标记的 Cookie 只能使用在 HTTP 请求过程中，所以无法通过 JavaScript 来读取这段 Cookie | 1. 充分利用好 Cookie 的 SameSite 属性,SameSite 选项通常有 Strict、Lax 和 None 三个值。<br>a.Strict 最为严格。如果 SameSite 的值是 Strict，那么浏览器会完全禁止第三方 Cookie。<br>b.Lax 相对宽松一点。在跨站点的情况下，从第三方站点的链接打开和从第三方站点提交 Get 方式的表单这两种方式都会携带 Cookie。<br>c.果使用 None 的话，在任何情况下都会发送 Cookie 数据。<br>2. 验证请求的来源站点。服务器的策略是优先判断 Origin，如果请求头中没有包含 Origin 属性，再根据实际情况判断是否使用 Referer 值。<br>3.CSRF Token：<br>1.在浏览器向服务器发起请求时，服务器生成一个 CSRF Token，然后将该字符串植入到返回的页面中。<br>2.在浏览器端如果要发起转账的请求，那么需要带上页面中的 CSRF Token，然后服务器会验证该 Token 是否合法。 |

